clc,clear
x24=[0.161 0.423 0.188 0.426 0.380 0.395 0.280 0.439 0.428];
x26=[0.175 0.424 0.220 0.406 0.349 0.429 0.272 0.465 0.439];
x27=[0.171 0.403 0.218 0.298 0.364 0.405 0.288 0.448 0.424];
x41=[0.333 0.414 0.222 0.386 0.379 0.433 0.268 0.426 0.401];
x42=[0.184 0.414 0.224 0.582 0.410 0.387 0.304 0.402 0.411];
x43=[0.160 0.409 0.222 0.460 0.385 0.428 0.290 0.434 0.411];
x45=[0.180 0.420 0.218 0.385 0.391 0.417 0.273 0.407 0.428];
x46=[0.175 0.399 0.221 0.407 0.355 0.425 0.282 0.379 0.739];
x52=[0.184 0.411 0.699 0.820 0.384 0.407 0.500 0.434 0.447];
x53=[0.178 0.411 0.216 0.373 0.346 0.403 0.273 0.413 0.392];
x55=[0.179 0.414 0.218 0.352 0.366 0.395 0.245 0.424 0.450];
x56=[0.211 0.430 0.219 0.409 0.388 0.403 0.289 0.356 0.423];
x60=[0.177 0.417 0.222 0.406 0.371 0.405 0.317 0.431 0.422];
x69=[0.182 0.435 0.215 0.407 0.389 0.387 0.122 0.099 0.905];
a0=[15.2 15.9 18.7 22.4 26.9 28.3 30.5
    33.8 40.4 50.7 58 66.7 81.2 83.4];
a=x69
a=a';a=a(:);a=a';%把原始数据按照时间顺序展开成一个行向量
Rt=tiedrank(a)%求原始时间序列的秩
n=length(a);t=1:n;
Qs=1-6/(n*(n^2-1))*sum((t-Rt).^2)%计算Qs的值
T=Qs*sqrt(n-2)/sqrt(1-Qs^2)%计算T统计量的值
t_0=tinv(0.975,n-2)%计算上alpha/2分位数
% b=diff(a)%求原始时间序列的一阶差分
% m=ar(b,2,'ls')%利用最小二乘法估计模型的参数
% bhat=predict(m,b')%求原始数据的预测值，第二个参数必须为列向量
% bhat(end+1)=forecast(m,b',1)%计算1个预测值，第二个参数必须为列向量
% ahat=[a(1),a+bhat']%求原始数据的预测值，并计算t=15的预测值
% delta=abs((ahat(1:end-1)-a)./a)%计算原始数据预测的相对误差
% xlswrite('yu.xls',ahat),xlswrite('yu.xls',delta,'Sheet1','A3')
% %数据写到Excel文件中